services:
  img-tg-r2:
    image: ghcr.io/yima8966216/img-tg-r2:latest
    container_name: img-tg-r2
    restart: unless-stopped
    ports:
      - "33000:33000"
    environment:
      # 管理员账号配置
      - ADMIN_USERNAME=${ADMIN_USERNAME:-admin}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD:-admin123}
      
      # 默认存储方式
      - DEFAULT_STORAGE=${DEFAULT_STORAGE:-telegraph}
      
      # Telegraph 配置
      - TG_BOT_TOKEN=${TG_BOT_TOKEN:-}
      - TG_CHAT_ID=${TG_CHAT_ID:-}
      
      # Cloudflare R2 配置
      - R2_ACCOUNT_ID=${R2_ACCOUNT_ID:-}
      - R2_ACCESS_KEY_ID=${R2_ACCESS_KEY_ID:-}
      - R2_SECRET_ACCESS_KEY=${R2_SECRET_ACCESS_KEY:-}
      - R2_BUCKET_NAME=${R2_BUCKET_NAME:-}
      - R2_PUBLIC_DOMAIN=${R2_PUBLIC_DOMAIN:-}
      
      # Node 环境
      - NODE_ENV=production
    volumes:
      # 持久化数据目录（包含索引文件和配置文件）
      - ./data:/app/data
    networks:
      - img-tg-r2-network

networks:
  img-tg-r2-network:
    driver: bridge

